<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="index_files/libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="index_files/libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Romain Avouac, Thomas Faria, Lino Galiana, Olivier Meslin, Tom Seimandi">
  <title>Bonnes pratiques pour les projets statistiques</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="_extensions/InseeFrLab/onyxia/logo.css">
  <link rel="stylesheet" href="custom.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="_extensions/InseeFrLab/onyxia/background.svg" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Bonnes pratiques pour les projets statistiques</h1>
  <p class="subtitle"></p><p><strong><span class="orange">Formation à la DESE</span></strong></p><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
 
</div>
</div>
</div>

  <p class="date">Invalid Date</p>
</section>
<section>
<section id="introduction" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>Introduction</h1>

</section>
<section id="la-notion-de-bonnes-pratiques" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>La notion de bonnes pratiques</h2>
<ul>
<li><span class="blue2"><strong>Origine</strong></span> : communauté des développeurs logiciels</li>
</ul>
<div class="fragment">
<ul>
<li><span class="blue2"><strong>Constats</strong></span> :
<ul>
<li>le <span class="green2"><em>“code est plus souvent lu qu’écrit”</em></span> (<a href="https://fr.wikipedia.org/wiki/Guido_van_Rossum">Guido Van Rossum</a>)</li>
<li>la maintenance d’un code est très coûteuse</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="blue2"><strong>Conséquence</strong></span> : un ensemble de <span class="orange"><strong>règles informelles</strong></span>, conventionnellement acceptées comme produisant des logiciels <span class="orange"><strong>fiables</strong></span>, <span class="orange"><strong>évolutifs</strong></span> et <span class="orange"><strong>maintenables</strong></span></li>
</ul>
</div>
</section>
<section id="pourquoi-sintéresser-aux-bonnes-pratiques" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2>Pourquoi s’intéresser aux bonnes pratiques ?</h2>
<p><br></p>
<p>L’activité du statisticien / <em>datascientist</em> tend à se rapprocher de celle du développeur :</p>
<div class="fragment">
<ul>
<li>projets <span class="orange"><strong>intenses en code</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>projets collaboratifs</strong></span> et de grande envergure</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>complexification</strong></span> des données et donc des <span class="orange"><strong>infrastructures</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>déploiement</strong></span> d’applications pour valoriser les analyses</li>
</ul>
</div>
</section>
<section id="bonnes-pratiques-et-reproductibilité" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2>Bonnes pratiques et reproductibilité</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/reprospectrum.png" height="200"></p>
</figure>
</div>
<p><strong>Source</strong> : Peng R., Reproducible Research in Computational Science, Science (2011)</p>
<div class="fragment">
<ul>
<li>Une reproductibilité parfaite est <span class="orange"><strong>coûteuse</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><code>Git</code> est un <span class="orange"><strong>standard atteignable</strong></span> et <span class="orange"><strong>efficient</strong></span></li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><strong>Quel socle de bonnes pratiques pour les projets statistiques en <code>R</code> ?</strong></p>
</div>
</div>
</div>
</div>
</section>
<section id="plan-de-la-formation" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Plan de la formation</h2>
<p>Améliorations graduelles dans l’échelle de la reproductibilité :</p>
<p><span class="emoji" data-emoji="one">1️⃣</span> Qualité du code</p>
<div class="fragment">
<p><span class="emoji" data-emoji="two">2️⃣</span> Structure des projets</p>
</div>
<div class="fragment">
<p><span class="emoji" data-emoji="three">3️⃣</span> Formats de données</p>
</div>
<div class="fragment">
<p><span class="emoji" data-emoji="four">4️⃣</span> Environnements reproductibles</p>
</div>
<div class="fragment">
<p><span class="emoji" data-emoji="five">5️⃣</span> <em>Pipelines</em> de données</p>
</div>
<div class="fragment">
<p><span class="emoji" data-emoji="six">6️⃣</span> Publication reproductible</p>
</div>
</section>
<section id="exercice-0" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 0</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Préparation de l’environnement de travail</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Créer un nouveau dépôt public sur <a href="https://github.com/">GitHub</a></li>
<li class="fragment">Lancer un service <code>RStudio</code> sur le <a href="https://datalab.sspcloud.fr/home">Datalab</a></li>
<li class="fragment">Utiliser un <code>terminal</code> pour activer le stockage des identifiants :
<ul>
<li class="fragment"><code>git config --global credential.helper store</code></li>
</ul></li>
<li class="fragment">Cloner le dépôt distant sur votre environnement local (<code>Datalab</code>):
<ul>
<li class="fragment"><code>File</code> → <code>New project</code> → <code>Version Control</code> → <code>Git</code></li>
</ul></li>
<li class="fragment">Créer le script <code>script.R</code> dans votre dépôt en copiant le contenu du fichier qui se trouve <a href="https://raw.githubusercontent.com/InseeFrLab/formation-bonnes-pratiques-R/main/script.R">ici</a></li>
<li class="fragment">Créer un script <code>write_csv.R</code> en copiant le contenu de celui se trouvant <a href="https://raw.githubusercontent.com/InseeFrLab/formation-bonnes-pratiques-R/main/write_csv.R">ici</a>, puis l’exécuter. Il récupére des données et en écrit un échantillon sur lequel nous allons travailler</li>
<li class="fragment">Ajouter “individu_reg.*” au fichier <code>.gitignore</code></li>
<li class="fragment"><em>commit</em>/<em>push</em> les changements</li>
</ol>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="i--qualité-du-code" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>I- Qualité du code</h1>

</section>
<section id="enjeux" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Enjeux</h2>
<ul>
<li>D’une vision utilitariste du code à une vision du code comme <span class="orange"><strong>outil de communication</strong></span></li>
</ul>
<div class="fragment">
<ul>
<li>Favoriser la <span class="orange"><strong>lisibilité</strong></span> et la <span class="orange"><strong>maintenabilité</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Faciliter la <span class="orange"><strong>réutilisation</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Assurer la <span class="orange"><strong>transparence</strong></span> méthodologique</li>
</ul>
</div>
</section>
<section id="principes-généraux" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Principes généraux</h2>
<ol type="1">
<li>Adopter les <span class="orange"><strong>standards communautaires</strong></span></li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>Utiliser des <span class="orange"><strong>fonctions</strong></span></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="orange"><strong>Documenter</strong></span> son code</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li>Indiquer les <em>packages</em> utilisés afin d’éviter les <span class="orange"><strong>conflits</strong></span></li>
</ol>
</div>
</section>
<section id="adopter-les-standards-communautaires" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Adopter les standards communautaires</h2>
<blockquote>
<p><em>“Good coding style is like correct punctuation: you can manage without it, butitsuremakesthingseasiertoread”</em></p>
<p><a href="https://style.tidyverse.org/">Tidyverse Style Guide</a></p>
</blockquote>
<div class="fragment">
<ul>
<li>Respecter les <span class="orange">conventions</span> du langage dans lequel il est rédigé</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Il existe un <strong>guide de référence</strong> pour bien coder en <code>R</code> : le <a href="https://style.tidyverse.org/index.html">Tidyverse style guide</a>.</li>
</ul>
</div>
</section>
<section id="adopter-les-standards-communautaires-1" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Adopter les standards communautaires</h2>
<p>Deux outils pratiques aident à respecter les standards :</p>
<ol type="1">
<li><span class="orange"><strong><em>linter</em></strong></span>: programme qui vérifie que le code est <strong>formellement</strong> conforme à un certain <em>guidestyle</em>
<ul>
<li>signale problèmes formels, sans corriger</li>
</ul></li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><span class="orange"><strong><em>formatter</em></strong></span>: programme qui reformate un code pour le rendre conforme à un certain <em>guidestyle</em>
<ul>
<li>modifie directement le code</li>
</ul></li>
</ol>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<ul>
<li><span class="blue2">Exemples d’erreurs repérées</span> par un <em>linter</em> :
<ul>
<li>lignes de code trop longues ou mal indentées, parenthèses non équilibrées, noms de fonctions mal construits…</li>
</ul></li>
<li><span class="blue2">Exemples d’erreurs <strong>non</strong> repérées</span> par un <em>linter</em> :
<ul>
<li>fonctions mal utilisées, arguments mal spécifiés, structure du code incohérente, code insuffisamment documenté…</li>
</ul></li>
</ul>
</div>
</div>
</div>
<!--------- VERSION SITE WEB 
1. Un [**_linter_**]{.orange} est un programme qui vérifie que le code est __formellement__ conforme à un certain _guidestyle_, et signale les erreurs. En revanche, un _linter_ ne modifie pas directement le code et ne repère pas les erreurs de fond.

  &#8627; Exemples d’erreurs repérées par un _linter_ : lignes de code trop longues ou mal indentées, parenthèses non équilibrées, noms de fonctions mal construits…
  &#8627; Exemples d’erreurs __non__ repérées par un _linter_ : fonctions mal utilisées, arguments mal spécifiés, structure du code incohérente, code insuffisamment documenté…
. . .

2. Un [**_formatter_**]{.orange} est un programme qui reformate un code source pour le rendre conforme à un certain _guidestyle_. Par définition, un _formatter_ modifie directement le code.
-------->
</div>
</section>
<section id="adopter-les-standards-communautaires-2" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Adopter les standards communautaires</h2>
<p><br></p>
<p>Dans le cas de <i class="fa-brands fa-r-project" aria-hidden="true"></i> :</p>
<ul>
<li>le <span class="orange"><em>linter</em></span> à utiliser est le <em>package</em> <a href="https://github.com/r-lib/lintr"><code>lintr</code></a>;</li>
<li>le <span class="orange"><em>formatter</em></span> à utiliser est le <em>package</em> <a href="https://github.com/r-lib/styler"><code>styler</code></a>.
<ul>
<li>Existe également le <em>package</em> <a href="https://github.com/yihui/formatR"><code>formatR</code></a>.</li>
</ul></li>
</ul>
</section>
<section id="utiliser-des-fonctions" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="two">2️⃣</span> Utiliser des fonctions</h2>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Règle d’or</strong></p>
</div>
<div class="callout-content">
<p>Il faut utiliser une <span class="red2"><strong>fonction</strong></span> dès qu’on utilise une même portion de code plus de deux fois (<span class="red2"><strong><em>don’t repeat yourself</em> (DRY)</strong></span>)</p>
</div>
</div>
</div>
<ul>
<li><span class="orange">Limite les risques d’erreurs</span> liés aux copier/coller</li>
<li>Rend le code <span class="orange">plus lisible</span> et <span class="orange">plus compact</span></li>
<li><span class="orange">Un seul endroit</span> du code à modifier lorsqu’on souhaite modifier le traitement</li>
<li>Facilite la <span class="orange">réutilisation</span> et la <span class="orange">documentation</span> du code !</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Règles pour écrire des fonctions <strong>pertinentes</strong></strong></p>
</div>
<div class="callout-content">
<ul>
<li>Une tâche = une fonction ;</li>
<li>Une tâche complexe = un enchaînement de fonctions réalisant chacune une tâche simple ;</li>
<li>Limiter l’utilisation de variables globales.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="documenter-son-code" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="three">3️⃣</span> Documenter son code</h2>
<ul>
<li>Grands principes :
<ul>
<li>Documenter le <span class="orange"><strong>pourquoi</strong></span> plutôt que le <span class="orange"><strong>comment</strong></span> ;</li>
<li>Privilégier auto-documentation via des <span class="orange"><strong>nommages pertinents</strong></span>.</li>
</ul></li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Comment bien documenter un script ?</strong></p>
</div>
<div class="callout-content">
<ul>
<li><span class="orange"><strong>Minimum</strong></span> 🚦 : commentaire au début du script pour décrire ce qu’il fait ;</li>
<li><span class="orange"><strong>Bien</strong></span> 👍 : commenter les parties “délicates” du code ;</li>
<li><span class="orange"><strong>Idéal</strong></span> 💪 : documenter ses fonctions avec la syntaxe <code>roxygen2</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="pas-dambiguité-sur-les-packages-utilisés" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="four">4️⃣</span> Pas d’ambiguité sur les <em>packages</em> utilisés</h2>
<ul>
<li>Deux fonctions peuvent avoir le <span class="orange"><strong>même nom</strong></span> dans des <span class="orange"><strong>packages différents</strong></span></li>
</ul>
<div class="fragment">
<ul>
<li><code>R</code> utilise par défaut la librairie chargée le plus récemment</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Erreurs difficiles à repérer car il est nécessaire d’exécuter le code</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Recommandation : indiquer explicitement le <em>package</em> : notation <code>package::fonction()</code>
<ul>
<li>Exemple <code>dplyr::filter()</code></li>
</ul></li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Exemple</strong></p>
</div>
<div class="callout-content">
<ul>
<li><code>package1</code> et <code>package2</code> contiennent chacun une fonction appelée <code>superFonction</code>.</li>
<li>Si <code>package2</code> est chargé après <code>package1</code>, alors <code>superFonction</code> désigne par défaut la fonction de <code>package2</code>.</li>
<li>Mieux vaut noter <code>package1::superFonction</code> et <code>package2::superFonction</code></li>
</ul>
</div>
</div>
</div>
<!------ Pour la version blog

Des packages contenant des fonctions homonymes peuvent être à l’origine de conflits. Ceci est dû au fait que R utilise par défaut la fonction du package chargé le plus récemment.

    Exemple: si les packages package1 et package2 contiennent chacun une fonction appelée superFonction, et si package2 est chargé après package1, alors superFonction désigne par défaut la fonction de package2.

Cette ambiguïté peut entraîner des erreurs difficiles à repérer, car le code donne l’impression d’appeler la bonne fonction. C’est pourquoi il est recommandé d’indiquer explicitement le package utilisé en utilisant la notation package::fonction() (par exemple dplyr::filter()).

:::{.callout-tip}
## Le_package_[`conflicted`](https://github.com/r-lib/conflicted#conflicted)

Le_package_`conflicted` aide à gérer les conflits de_packages_de manière fluide.
:::
------>
</div>
</section>
<section id="ressources-supplémentaires" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Ressources supplémentaires</h2>
<p><br></p>
<ul>
<li><a href="https://r-pkgs.org/man.html"><em>R Packages</em></a> par Hadley Wickham and Jenny Bryan</li>
<li>Une <a href="https://mitmat.github.io/slides/2022-05-26-egu/code-data-open-science.html#1">présentation très bien faite</a></li>
<li><a href="https://eliocamp.github.io/reproducibility-with-r/">Un cours complet</a> sur la reproductibilité avec <code>R</code></li>
<li>L’équivalent <code>Python</code> en <a href="https://ensae-reproductibilite.netlify.app/about/">3A d’ENSAE</a></li>
</ul>
</section>
<section id="exercice-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 1</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Partie 1: préparation de l’environnement</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Installer les <em>packages</em> <code>R</code> <a href="https://github.com/r-lib/lintr"><code>lintr</code></a> et <a href="https://www.tidyverse.org/blog/2017/12/styler-1.0.0/"><code>styler</code></a>.</li>
<li class="fragment">Si ce n’est pas déjà fait, faire un <em>commit</em> de <code>script.R</code> .</li>
<li class="fragment">Définir le <em>linter</em> à utiliser comme étant de type <code>tidyverse</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-1-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 1</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Partie 2: premiers standards de qualité</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Utiliser l’<em>addin</em> de <code>lintr</code> pour diagnostiquer le script <code>script.R</code> (<code>Addins &gt; Lint current file</code>).
<ul>
<li class="fragment">Regardez bien la liste des problèmes détectés par le <em>linter</em>.</li>
<li class="fragment">Comprenez-vous la nature des problèmes?</li>
</ul></li>
<li class="fragment">Utiliser l’<em>addin</em> de <code>styler</code> pour nettoyer le fichier (<code>Addins &gt; Style active file</code>).
<ul>
<li class="fragment">Que se passe-t-il d’inattendu? Comprenez-vous le problème?</li>
<li class="fragment">Lorsque vous avez trouvé le problème, vous pouvez le corriger puis faire un <em>commit</em>.</li>
</ul></li>
<li class="fragment">Utiliser à nouveau l’<em>addin</em> de <code>styler</code> pour nettoyer le fichier.
<ul>
<li class="fragment">Enregistrer et faire un <em>commit</em> du fichier.</li>
<li class="fragment">Prenez le temps de regarder le <em>diff</em> du <em>commit</em>. Comprenez-vous les modifications faites par le <em>formatter</em>?</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-1-2" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 1</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Application des standards de qualité de code (suite)</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Refaire tourner le <em>linter</em>. Il reste encore un certain nombre d’erreurs de formattage, car <code>styler</code> est un <em>formatter</em> peu intrusif.</li>
<li class="fragment">On va maintenant configurer le <em>linter</em> pour qu’il propose une analyse beaucoup plus rigoureuse. Pour cela, exécuter le code suivant.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>linters_complets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"best_practices"</span>, <span class="st">"common_mistakes"</span>, <span class="st">"correctness"</span>, <span class="st">"efficiency"</span>, <span class="st">"readability"</span>, <span class="st">"style"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>lintr<span class="sc">::</span><span class="fu">lint</span>(<span class="st">"script.R"</span>, <span class="at">linters =</span> lintr<span class="sc">::</span><span class="fu">linters_with_tags</span>(linters_complets))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li class="fragment">Regarder la liste des problèmes repérés par le <em>linter</em>, et la comparer avec celle de l’étape précédente.
<ul>
<li class="fragment">Comprenez-vous les nouveaux problèmes repérés par le <em>linter</em>?<br>
<!-- 9. On peut maintenant tester un autre _formatter_ plus intrusif. Pour cela, --> <!-- installer le _package_ `formatR`, exécuter `formatR::tidy_source("script.R", width.cutoff = 50)`. Régler les erreurs inattendues s'il y en a. Le script reformatté est imprimé dans la console. Copier le script reformatté, et le coller dans l'éditeur et remplacer. A ce stade, faire un _commit_. Prenez le temps de regarder le _diff_ du _commit_. Comprenez-vous les modifications faites par le _formatter_? --> <!-- 10. Refaire tourner le _linter_. Corriger les lignes manuellement (vous pouvez utiliser <kbd>CTRL</kbd>+<kbd>I</kbd> pour aligner des lignes ensemble).  --></li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="ii--structure-des-projets" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>II- Structure des projets</h1>

</section>
<section id="enjeux-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Enjeux</h2>
<ol type="1">
<li>Favoriser la <span class="orange"><strong>lisibilité</strong></span> et la <span class="orange"><strong>maintenabilité</strong></span></li>
</ol>
<div class="fragment">
<p>2 Construire des projets <span class="orange"><strong>reproductibles</strong></span></p>
</div>
</section>
<section id="a-ne-pas-reproduire-chez-vous" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="warning">⚠️</span> A ne pas reproduire chez vous</h2>
<p><br></p>
<pre><code>├── report.Rmd
├── correlation.png
├── data.csv
├── data2.csv
├── fig1.png
├── figure 2 (copy).png
├── report.pdf
├── partial data.csv
├── script.R
└── script_final.R</code></pre>
<p>Source : <a href="https://eliocamp.github.io/reproducibility-with-r/materials/day1/02-projects/">eliocamp.github.io</a></p>
</section>
<section id="principes-généraux-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Principes généraux</h2>
<ol type="1">
<li>Utiliser les <span class="orange"><strong>projets RStudio</strong></span></li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li>Organiser son projet en <span class="orange"><strong>sous-dossiers</strong></span></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Donner des <span class="orange"><strong>noms pertinents</strong></span> aux fichiers</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="orange"><strong>Documenter</strong></span> son projet</li>
</ol>
</div>
</section>
<section id="utiliser-les-projets-rstudio" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Utiliser les projets RStudio</h2>
<ul>
<li><span class="orange"><strong>Objectif</strong></span> : favoriser la <span class="blue2"><strong>reproductibilité</strong></span>
<ul>
<li>Tous les fichiers nécessaires au projet dans un même dossier ;</li>
<li>Le dossier contenant le projet RStudio est automatiquement utilisé comme <strong><em>working directory</em></strong> ;</li>
<li>Utilisation de <span class="blue2"><strong>chemins relatifs</strong></span> plutôt qu’absolus.</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><strong>Bonus</strong> : en utilisant <code>Git</code>, on s’assure de toujours travailler dans un projet RStudio !</li>
</ul>
</div>
</section>
<section id="organiser-son-projet-en-sous-dossiers" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="two">2️⃣</span> Organiser son projet en sous-dossiers</h2>
<ul>
<li><span class="orange"><strong>Objectif</strong></span> : adopter une structure arbitraire, mais <span class="blue2"><strong>lisible</strong></span> et <span class="blue2"><strong>cohérente</strong></span></li>
</ul>
<pre><code>├── data
│   ├── raw
│   │   ├── data.csv
│   │   └── data2.csv
│   └── derived
│       └── partial data.csv
├── scripts
│   └── script.R
├── analysis
│   ├── script_final.R
│   └── report.Rmd
└── output
    ├── fig1.png
    ├── figure 2 (copy).png
    ├── figure10.png
    ├── correlation.png
    └── report.pdf</code></pre>
</section>
<section id="donner-des-noms-pertinents-aux-fichiers" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="three">3️⃣</span> Donner des noms pertinents aux fichiers</h2>
<ul>
<li><span class="orange"><strong>Objectif</strong></span> : <span class="blue2"><strong>auto-documenter</strong></span> son projet</li>
</ul>
<pre><code>├── data
│   ├── raw
│   │   ├── dpe_logement_202103.csv
│   │   └── dpe_logement_202003.csv
│   └── derived
│       └── dpe_logement_merged_preprocessed.csv
├── scripts
│   └── preprocessing.R
├── analysis
│   ├── generate_plots.R
│   └── report.Rmd
└── output
    ├── histogram_energy_diagnostic.png
    ├── barplot_consumption_pcs.png
    ├── correlation_matrix.png
    └── report.pdf</code></pre>
</section>
<section id="documenter-son-projet" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="four">4️⃣</span> Documenter son projet</h2>
<ul>
<li>Le fichier <code>README.md</code>, situé à la racine du projet, est à la fois la <strong>carte d’identité</strong> et la <strong>vitrine du projet</strong></li>
</ul>
<div class="fragment">
<ul>
<li>Idéalement, il contient :
<ul>
<li>Une <span class="orange"><strong>présentation</strong></span> du contexte et des objectifs</li>
<li>Une description de son <span class="orange"><strong>fonctionnement</strong></span></li>
<li>Un guide de <span class="orange"><strong>contribution</strong></span> (<em>open-source</em>)</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Quelques modèles de <code>README.md</code> complets :
<ul>
<li><a href="https://github.com/InseeFrLab/utilitR/blob/master/README.md">utilitR</a></li>
<li><a href="https://github.com/InseeFrLab/DoReMIFaSol">DoReMIFaSol</a></li>
</ul></li>
</ul>
</div>
</section>
<section id="ressources-supplémentaires-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Ressources supplémentaires</h2>
<p><br></p>
<ul>
<li>La documentation <a href="https://www.book.utilitr.org/rproject.html">utilitR</a></li>
<li><a href="https://eliocamp.github.io/reproducibility-with-r/materials/day1/02-projects/">eliocamp.github.io</a></li>
</ul>
</section>
<section id="exercice-2-15" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 2 (1/5)</h2>
<p>Cette application vise à résoudre une partie des problèmes détectés précédemment.</p>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Travail sur le fichier: modifications de structure</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Créer des parties dans <code>script.R</code> pour aider à la compréhension de la structure du fichier:
<ul>
<li class="fragment"><code># TITRE NIVEAU 1 ------------</code> et <code># TITRE NIVEAU 2 ==========</code></li>
<li class="fragment">Faire un <em>commit</em></li>
</ul></li>
<li class="fragment">Déplacer les <code>library</code> pour les mettre tous ensemble au début du script.
<ul>
<li class="fragment">Conserver l’ordre des <em>packages</em> (<code>MASS</code> après <code>tidyverse</code> notamment).</li>
<li class="fragment">Faire un <em>commit</em>.</li>
</ul></li>
<li class="fragment">Le script n’est pas construit dans un ordre logique. Déplacer les parties pour adopter une structure plus logique:
<ul>
<li class="fragment">Gestion de l’environnement -&gt; Définition de fonctions -&gt; Import des donnees -&gt; Retraitement des données -&gt; Statistiques descriptives -&gt; Graphiques -&gt; Modélisation</li>
<li class="fragment">Faire un <em>commit</em>.</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-2-25" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 2 (2/5)</h2>
<p>On va se pencher sur chaque partie du code maintenant qu’on y voit plus clair:</p>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modifications de la partie import des données</strong></p>
</div>
<div class="callout-content">
<div class="smaller">
<ol start="4" type="1">
<li class="fragment">Faire tourner le code jusqu’à l’import des données. Regarder les données.
<ul>
<li class="fragment">Quel problème repérez-vous?</li>
<li class="fragment">Corriger le problème en vous aidant de la documentation de <code>read_csv2</code>.</li>
</ul></li>
<li class="fragment">Faire tourner le code qui définit la table <code>df2</code>.
<ul>
<li class="fragment">Corriger le problème et faire un <em>commit</em>.</li>
</ul></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-2-35" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 2 (3/5)</h2>
<p>On se penche maintenant sur la partie retraitement des données :</p>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modifications de la partie restructuration des données</strong></p>
</div>
<div class="callout-content">
<div>
<ul>
<li class="fragment">Exécuter la partie de gestion des valeurs manquantes, remarquer des problèmes en regardant code et données.
<ul>
<li class="fragment">Utiliser les fonctions <code>dplyr::mutate</code>, <code>dplyr::na_if</code> et <code>dplyr::across</code> pour simplifier le code.</li>
<li class="fragment">Faire un <em>commit</em></li>
</ul></li>
<li class="fragment">S’occuper de la partie gestion des variables catégorielles.
<ul>
<li class="fragment">Repérer des problèmes en regardant les données et les corriger.</li>
<li class="fragment">Faire un <em>commit</em></li>
</ul></li>
<li class="fragment">Changer le type de la variable <code>aged</code> afin d’éviter les nombreux <code>as.numeric(aged)</code> ultérieurs.
<ul>
<li class="fragment">Remplacer toutes les occurrences de <code>as.numeric(aged)</code>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-2-45" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 2 (4/5)</h2>
<ul>
<li>On passe maintenant à la partie statistiques descriptives.
<ul>
<li>Après chaque question, faire un <em>commit</em></li>
</ul></li>
</ul>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modifications de la partie statistiques descriptives</strong></p>
</div>
<div class="callout-content">
<div>
<ul>
<li class="fragment">Corriger les erreurs sur le décompte des professions.</li>
<li class="fragment">Exécuter le code produisant les statistiques d’âge jusqu’à rencontrer l’erreur <code>Error in select(., aged) : unused argument (aged)</code>.
<ul>
<li class="fragment">Comment la résoudre ?</li>
</ul></li>
<li class="fragment">Récupérer les données utilisées lors de la production de <code>ggplot(.)</code> ;</li>
<li class="fragment">Remplacer le second <code>summarise</code> par la bonne commande dans la partie <code>#part d'homme dans chaque cohorte</code> ;</li>
<li class="fragment">Débugger la partie <code>#stats surf par statut</code> puis produire un graphique lisible ;</li>
<li class="fragment">Comprendre les erreurs dans la partie où on applique <code>fonction_de_stat_agregee</code> et les corriger.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-2-55" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 2 (5/5)</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modifications de la partie modélisation et gestion des secrets</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Régler les problèmes de la partie modélisation ;</li>
<li class="fragment">Traiter correctement les informations confidentielles (<em>secrets</em>) :</li>
</ol>
<ul>
<li class="fragment">Repérer le jeton d’API dans le code. Retirer le jeton d’API du code et créer un fichier YAML nommé <code>secrets.yaml</code> où vous écrivez ce secret sous la forme <code>key: value</code>.</li>
<li class="fragment">Dans <code>script.R</code>, importer ce YAML (avec <code>yaml::read_yaml("secrets.yaml"</code>) pour créer une variable <code>api_token</code> ayant cette valeur.</li>
<li class="fragment">Ajouter dans <code>.gitignore</code> le fichier <code>secrets.yaml</code> et indiquer dans le <code>README.md</code> de votre projet que les secrets sont stockés dans ce fichier.</li>
<li class="fragment"><span class="red2"><span class="emoji" data-emoji="warning">⚠️</span> Attention</span> : il ne faut pas committer <code>secrets.yaml</code> car le jeton d’API est personnel et secret!</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="bilan-de-lexercice" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Bilan de l’exercice</h2>
<ul>
<li>Un code mal structuré
<ul>
<li>Limite la lisibilité du projet</li>
<li>Est très coûteux à maintenir (dette technique)</li>
</ul></li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 72.7%;justify-content: center;">
<p><img data-src="https://www.earthdatascience.org/images/earth-analytics/clean-code/reproducible-science-is-about-being-lazy-hadley-wickham.png"></p>
</div>
</div>
</div>
</section>
<section id="checkpoint" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Checkpoint</h2>
<ul>
<li>Des dizaines de <code>script.R</code> différents peuvent être considérés valides à ce stade</li>
</ul>
<div class="fragment">
<ul>
<li>Si vous avez eu des difficultés avec une des questions, vous pouvez repartir de <a href="https://raw.githubusercontent.com/InseeFrLab/formation-bonnes-pratiques-R/649b8955600c85cbd62c08c9697a264be5279be2/script.R">cette version</a>
<ul>
<li>L’idéal est néanmoins que vous continuiez avec votre version</li>
</ul></li>
</ul>
</div>
</section>
<section id="exercice-3-modularisation-12" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 3: modularisation (1/2)</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Améliorer la fonction <code>fonction_de_stat_agregee</code></strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Lui donner un nom plus court.</li>
<li class="fragment">Remplacer la première partie par un <code>match.arg</code>.</li>
<li class="fragment">Remplacer la deuxième partie par <code>switch</code>.</li>
<li class="fragment">S’assurer qu’elle soit <strong>pure</strong>, c’est-à-dire qu’elle n’utilise pas de variables globales.</li>
<li class="fragment">Compter les erreurs de code que vous venez de corriger.</li>
<li class="fragment">Limiter la duplication de code en utilisant des <strong>fonctions</strong> et, quand c’est pertinent, en utilisant <code>lapply</code> pour les appliquer en série.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-3-modularisation-22" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 3: modularisation (2/2)</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Améliorer la fonction <code>fonction_de_stat_agregee</code> (suite)</strong></p>
</div>
<div class="callout-content">
<div>
<ol start="7" type="1">
<li class="fragment">Déplacer toutes les fonctions dans un fichier <code>R/functions.R</code>.</li>
<li class="fragment">Dans <code>script.R</code>, appeler en début de chaîne ces fonctions avec <code>source("R/functions.R", encoding = "UTF-8")</code>.</li>
<li class="fragment">Documenter la fonction en utilisant <code>roxygen2</code>.</li>
<li class="fragment">Redémarrer la session (en faisant <code>Session &gt; Restart R</code>). Si tout va bien, le code devrait maintenant fonctionner.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="checkpoint-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Checkpoint</h2>
<ul>
<li><a href="https://github.com/InseeFrLab/formation-bonnes-pratiques-R/blob/8d42730279619fb85a818e5fbde7176096915c94/script.R"><code>script.R</code></a></li>
<li><a href="https://raw.githubusercontent.com/InseeFrLab/formation-bonnes-pratiques-R/8d42730279619fb85a818e5fbde7176096915c94/R/functions.R"><code>R/functions.R</code></a></li>
</ul>
</section></section>
<section>
<section id="iii--formats-de-données" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>III- Formats de données</h1>

</section>
<section id="enjeux-2" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Enjeux</h2>
<ul>
<li>Le choix d’un format de données répond à un <span class="orange"><strong>arbitrage</strong></span> entre plusieurs critères :
<ul>
<li>Finalité (traitement, analyse, diffusion)</li>
<li>Public cible</li>
<li>Volumétrie</li>
</ul></li>
</ul>
</section>
<section id="recommandations" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2>Recommandations</h2>
<ul>
<li>Eviter impérativement les formats de données adhérents à un langage (<code>RDS</code>, <code>RData</code>, <code>fst</code>, <code>sas7bdat</code>, etc.).</li>
</ul>
<div class="fragment">
<ul>
<li>Deux formats à privilégier :
<ul>
<li><span class="orange"><strong>CSV</strong></span> : pour la <span class="blue2"><strong>plupart des usages courants</strong></span>
<ul>
<li><em>Avantage</em>: <span class="blue2"><strong>non-compressé</strong></span> donc facilement <span class="blue2"><strong>lisible</strong></span></li>
<li><em>Inconvénients</em> : pas de gestion des méta-données, peu adapté aux données volumineuses</li>
</ul></li>
<li><span class="orange"><strong>Parquet</strong></span> : pour le traitement de <span class="blue2"><strong>données volumineuses</strong></span>
<ul>
<li><span class="blue2"><strong>Compressé</strong></span> et très <span class="blue2"><strong>performant</strong></span> en lecture/écriture</li>
<li>Gestion native des méta-données</li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="exercice-4" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 4</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Manipulation des formats CSV et Parquet</strong></p>
</div>
<div class="callout-content">
<div>
<ul>
<li class="fragment">Effacer la base <code>individu_reg.csv</code> ;</li>
<li class="fragment">Transformer le script <code>write_csv.R</code> pour n’utiliser que le format <code>parquet</code>; sauvegarder la table <code>individu_reg</code> en format Parquet ;</li>
<li class="fragment">Modifier la phase d’import de <code>script.R</code> pour utiliser <code>arrow</code> et lire le fichier Parquet créé précédemment.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="iv--environnements-reproductibles" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>IV- Environnements reproductibles</h1>

</section>
<section id="expérience-de-pensée" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Expérience de pensée</h2>
<ul>
<li>Imaginons la situation suivante :
<ul>
<li>J’installe une version de <code>R</code> sur mon poste ;</li>
<li>Je développe un projet en installant les <em>packages</em> nécessaires ;</li>
<li>Une fois terminé, je passe au projet suivant, et ainsi de suite.</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>Quels problèmes puis-je rencontrer au fil des projets ?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Est-il facile de partager un de mes projets ?</li>
</ul>
</div>
</section>
<section id="enjeux-3" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Enjeux</h2>
<ul>
<li><span class="orange"><strong>Version de</strong></span> <span class="blue2"><strong>R</strong></span> <span class="orange"><strong>fixe</strong></span>, celle de l’installation système</li>
</ul>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Conflits de version</strong></span> : différents projets peuvent requérir différentes versions d’un même <em>package</em>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Reproductibilité limitée</strong></span> : difficile de dire quel projet nécessite quel <em>package</em>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Portabilité limitée</strong></span> : difficile de préciser dans un fichier les dépendances spécifiques à un projet.</li>
</ul>
</div>
</section>
<section id="exercice-5a" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 5A</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Création du fichier <code>Description</code></strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Utiliser <code>usethis::use_description(check_name = FALSE)</code> pour créer le modèle de fichier <code>Description</code>. Un nouveau fichier apparaît dans le dossier RStudio. Faire un <em>commit</em>.</li>
<li class="fragment">Taper <code>usethis::use_package("ggplot2")</code> dans la commande et observer le changement dans ce fichier <code>Description</code>. Faire un <em>commit</em>.</li>
<li class="fragment">Taper <code>usethis::use_package("tidyverse")</code> et observer le message.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-5a-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 5A</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modifications du fichier <code>Description</code></strong></p>
</div>
<div class="callout-content">
<ul>
<li>On va suivre le conseil des développeurs de <code>tidyverse</code>:
<ul>
<li>il vaut mieux retirer <code>tidyverse</code> des dépendances de notre code et plutôt lister uniquement les <em>packages</em> qu’on utilise.</li>
</ul></li>
</ul>
<div>
<ol type="1">
<li class="fragment">Retourner dans <code>script.R</code>. Repartir d’un environnement vide (en relançant <code>R</code>) et supprimer la ligne <code>library(tidyverse)</code></li>
<li class="fragment">Exécuter les lignes l’une après l’autre. S’il y a une erreur, vérifier la fonction responsable et son package associé.</li>
<li class="fragment">Vérifier que le code tourne toujours.</li>
<li class="fragment">Une fois que la liste est stabilisée faire <code>lapply(c("package1", "package2"...), usethis::use_package)</code> pour les ajouter au fichier <code>Description</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-5a-2" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 5A</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Utilisation du fichier <code>Description</code></strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Retirer les <code>install.packages</code> au début de <code>script.R</code>.</li>
<li class="fragment">Si vous ne l’avez pas déjà fait, retirer <code>rm(list = ls())</code>.</li>
<li class="fragment">En option, vous pouvez compléter les autres champs de votre <code>Description</code>.</li>
<li class="fragment">Committer et pusher les fichiers modifiés.</li>
<li class="fragment">Créer un nouveau service RStudio, comme dans l’exercice 0.</li>
<li class="fragment">Cloner le dépôt, comme dans l’exercice 0.</li>
<li class="fragment">Installer les dépendances du projet avec <code>devtools::install_deps(upgrade = "never")</code>.</li>
<li class="fragment">Tester <code>write_csv.R</code> puis <code>script.R</code>. Tout doit fonctionner (normalement…).</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="une-solution-plus-complète-renv" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Une solution plus complète : <code>renv</code></h2>
<ul>
<li><code>renv</code> permet de créer des <strong>env</strong>ironnements <strong>r</strong>eproductibles</li>
</ul>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Isolation</strong></span> : chaque projet dispose de sa propre librairie de packages</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Reproductibilité</strong></span> : <code>renv</code> enregistre les versions exactes des <em>packages</em> nécessaires au projet</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Portabilité</strong></span>: un tiers peut exécuter le projet avec les mêmes spécifications</li>
</ul>
</div>
</section>
<section id="utilisation-de-renv" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Utilisation de <code>renv</code></h2>
<ol type="1">
<li><span class="orange"><strong>Initialisation</strong></span> (<code>init</code>) de l’environnement local du projet</li>
</ol>
<div class="fragment">
<ol start="2" type="1">
<li><span class="orange"><strong>Développement</strong></span> du projet</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="orange"><strong>Enregistrement</strong></span> (<code>snapshot</code>) des versions des <em>packages</em> installés</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="orange"><strong>Restauration</strong></span> (<code>restore</code>) d’un environnement</li>
</ol>
</div>
</section>
<section id="initialisation-de-lenvironnement" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Initialisation de l’environnement</h2>
<ul>
<li><code>renv::init()</code> dans un projet RStudio crée :
<ul>
<li>Un dossier <code>renv</code> et le fichier <code>.Rprofile</code> : activation automatique de l’environnement</li>
<li>Le fichier <code>renv.lock</code> : versions des <em>packages</em> installés</li>
</ul></li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/renv_init.png" height="400"></p>
</figure>
</div>
</div>
</section>
<section id="développement-du-projet" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="two">2️⃣</span> Développement du projet</h2>
<ul>
<li>Une fois l’environnement initialisé, on développe le projet de manière habituelle
<ul>
<li>Installations/suppressions/mises à jour de packages</li>
<li>Ecriture de scripts</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><code>renv::status()</code> : indique les <em>packages</em> installés/supprimés par rapport au fichier <code>renv.lock</code></li>
</ul>
</div>
</section>
<section id="enregistrement-de-lenvironnement" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="three">3️⃣</span> Enregistrement de l’environnement</h2>
<ul>
<li><code>renv::snapshot()</code> : enregistre les versions des <em>packages</em> installés dans le fichier <code>renv.lock</code></li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/renv_snapshot.png" height="400"></p>
</figure>
</div>
</div>
</section>
<section id="restauration-de-lenvironnement" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="four">4️⃣</span> Restauration de l’environnement</h2>
<ul>
<li><code>renv::restore()</code> : installe/désinstalle les <em>packages</em> nécessaires pour arriver à l’état spécifié dans le fichier <code>renv.lock</code></li>
</ul>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Portabilité</strong></span> : un tiers peut recréer un environnement avec les mêmes spécifications</li>
</ul>
</div>
</section>
<section id="exercice-5b" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 5B</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Prise en main de la librairie <code>renv</code></strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment"><p>Taper dans la console <code>renv::init()</code>, <strong>lire le message</strong> et accepter.</p></li>
<li class="fragment"><p>Observer le dossier <code>renv</code> qui apparaît.</p></li>
<li class="fragment"><p>Installer le <a href="https://gt.rstudio.com/">package <code>gt</code></a> et observer le message dans la console.</p></li>
<li class="fragment"><p>Dans la partie sur les statistiques descriptives d’âge, ajouter ce code :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>stats_age <span class="ot">&lt;-</span> df2 <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">group_by</span>(<span class="at">decennie =</span> <span class="fu">decennie_a_partir_annee</span>(age)) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">summarise</span>(<span class="fu">n</span>())</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>table_age <span class="ot">&lt;-</span> <span class="fu">gt</span>(stats_age) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="at">title =</span> <span class="st">"Distribution des âges dans notre population"</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="at">columns =</span> <span class="st">`</span><span class="at">n()</span><span class="st">`</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="at">sep_mark =</span> <span class="st">" "</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb5-15"><a href="#cb5-15"></a>    <span class="at">decennie =</span> <span class="st">"Tranche d'âge"</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>    <span class="st">`</span><span class="at">n()</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Population"</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-5b-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 5B</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Prise en main de la librairie <code>renv</code> (suite)</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Dans la console, faire <code>renv::snapshot()</code> et observer le message.</li>
<li class="fragment">Faire un <em>commit</em> et un <em>push</em> des fichiers <code>script.R</code>, <code>.Rprofile</code>, <code>renv.lock</code> et du dossier <code>renv/</code>. <em>Push</em>.</li>
<li class="fragment">Ouvrir un nouveau service <code>RStudio</code> sur le <code>SSPCloud</code> et cloner le projet dans les mêmes conditions que l’exercice 0. Regarder les messages dans la console.</li>
<li class="fragment">Exécuter <code>renv::status()</code> dans la console. Constater que les <em>packages</em> ne sont pas installés par <code>renv</code>, car c’est à l’utilisateur de décider de le faire. Faire <code>renv::install()</code>. Par défaut, <code>renv</code> installe les dépendances manuellement ajoutées dans <code>DESCRIPTION</code>.</li>
<li class="fragment">Refaire un <code>renv::status()</code>. Les dépendances manquantes doivent être ajoutées au <code>DESCRIPTION</code> avec <code>usethis::use_package</code>.</li>
<li class="fragment">Refaire <code>renv::install()</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="vers-une-reproductibilité-optimale" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Vers une reproductibilité optimale</h2>
<ul>
<li><span class="orange"><strong>Limites</strong></span> des environnements virtuels :
<ul>
<li>Les <span class="blue2"><strong>librairies système</strong></span> ne sont pas gérées</li>
<li>Lourdeur de la phase d’installation à chaque changement d’environnement</li>
<li>Peu adaptés à un environnement de production</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li>La <span class="orange"><strong>conteneurisation</strong></span> (ex : <code>Docker</code>) apporte la solution</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="orange"><strong>Intuition</strong></span> : au lieu de distribuer la recette pour recréer l’environnement, <span class="blue2"><strong>distribuer directement une “machine” qui contient <em>tout</em> l’environnement nécessaire au projet</strong></span></li>
</ul>
</div>
</section>
<section id="ressources-supplémentaires-2" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Ressources supplémentaires</h2>
<ul>
<li><p>La <a href="https://rstudio.github.io/renv/articles/renv.html">documentation officielle de <code>renv</code></a></p></li>
<li><p><a href="https://elise.maigne.pages.mia.inra.fr/2021_package_renv/presentation.html#1">Une présentation sur <code>renv</code></a></p></li>
</ul>
</section></section>
<section>
<section id="v--pipelines-de-données" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>V- <em>Pipelines</em> de données</h1>

</section>
<section id="motivations" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Motivations</h2>
<ul>
<li>Une analyse de données ou une chaîne de production font intervenir des <span class="orange"><strong>étapes standardisées</strong></span></li>
</ul>
<div class="fragment">
<ul>
<li>Modéliser ces étapes sous forme de <span class="orange"><strong>pipeline (<em>direct acyclic graph</em>)</strong></span> a plusieurs avantages :
<ul>
<li><span class="blue2"><strong>Découplage</strong></span> des différentes étapes</li>
<li>Facilite la <span class="blue2"><strong>planification</strong></span> du traitement</li>
<li>Facilite la <span class="blue2"><strong>prise en main</strong></span> du projet par un tiers</li>
</ul></li>
</ul>
</div>
</section>
<section id="targets" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>targets</h2>
<ul>
<li><code>targets</code> est un <em>framework</em> de modélisation de <em>pipelines</em> spécifiquement dédié aux projets <code>R</code>.</li>
</ul>
<div class="fragment">
<ul>
<li>Deux objectifs majeurs :
<ol type="1">
<li><span class="orange"><strong>Réduire le coût d’expérimentation</strong></span> en sauvegardant les résultats intermédiaires (<strong><em>targets</em></strong>)</li>
<li>Garantir la <span class="orange"><strong>reproductibilité</strong></span> de la chaîne en traçant les changements de ces <strong><em>targets</em></strong></li>
</ol></li>
</ul>
</div>
</section>
<section id="utilisation-de-targets" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Utilisation de <code>targets</code></h2>
</section>
<section id="un-projet-minimaliste" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="one">1️⃣</span> Un projet minimaliste</h2>
<pre><code>├── _targets.R
├── data
│   ├── raw
│   │   └── data.csv
├── scripts
│   └── fonctions.R</code></pre>
</section>
<section id="le-fichier-_targets.r" class="slide level2 smaller" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="two">2️⃣</span> Le fichier <code>_targets.R</code></h2>
<ul>
<li>Le fichier <code>_targets.R</code> doit satisfaire plusieurs conditions :
<ol type="1">
<li>Charger le_package_<code>targets</code> ;</li>
<li>Charger dans l’environnement les fonctions nécessaires ;</li>
<li>Déclarer les_packages_nécessaires aux différentes étapes ;</li>
<li>Définir le <em>pipeline</em>.</li>
</ol></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/targets.png" height="250"></p>
</figure>
</div>
</section>
<section id="inspecter-le-pipeline" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="three">3️⃣</span> Inspecter le <em>pipeline</em></h2>
<ul>
<li>La fonction <code>tar_visnetwork</code> permet de visualiser le <em>pipeline</em></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/pipeline.png" height="350"></p>
</figure>
</div>
</section>
<section id="exécuter-le-pipeline" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><span class="emoji" data-emoji="three">3️⃣</span> Exécuter le <em>pipeline</em></h2>
<ul>
<li>La fonction <code>tar_make</code> exécute le <em>pipeline</em></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/pipeline_run1.png" height="200"></p>
</figure>
</div>
<ul>
<li>Lors des exécutions suivantes, <code>targets</code> saute automatiquement les étapes qui n’ont pas changé</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/pipeline_run2.png" height="100"></p>
</figure>
</div>
</section>
<section id="ressources-supplémentaires-3" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Ressources supplémentaires</h2>
<ul>
<li>La <a href="https://books.ropensci.org/targets/">documentation officielle de <code>targets</code></a></li>
</ul>
</section>
<section id="exercice-6a" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 6A</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modélisation d’un projet sous forme de <em>pipeline</em> de données</strong></p>
</div>
<div class="callout-content">
<div>
<ol type="1">
<li class="fragment">Partir de l’exemple de <a href="https://books.ropensci.org/targets/walkthrough.html"><code>_targets.R</code></a> pour créer un fichier <code>_targets.R</code> dans la documentation.</li>
<li class="fragment">Ajouter <code>_targets/</code> dans le .gitignore.</li>
<li class="fragment">Commençons par les dépendances. Reporter les <code>library</code> dans le fichier <code>R/functions.R</code> et récupérer les noms des packages pour les mettre dans la section <code>tar_option_set()</code>.</li>
<li class="fragment">Créer dans <code>R/functions.R</code>, une fonction <code>read_yaml_secret</code> et une <code>read_from_parquet</code> qui prennent en argument un chemin et exportent, respectivement, le jeton de l’API et notre dataframe de départ.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-6a-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 6A</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Modélisation d’un projet sous forme de <em>pipeline</em> de données (suite)</strong></p>
</div>
<div class="callout-content">
<div>
<ol start="5" type="1">
<li class="fragment">A partir du modèle dans la documentation de <code>targets</code>, créer les quatre premières cibles (<em>targets</em>): les deux fichiers (utiliser l’argument <code>format</code>) et les deux objets <code>R</code> construits à partir des fonctions <code>read_yaml_secret</code> et <code>read_from_parquet</code>. Nommer ces cibles, respectivement <code>pwd_api</code> et <code>survey_sample_24</code>. Pour la cible utilisant <code>survey_sample_24</code> ajouter l’argument <code>format="parquet"</code>.</li>
<li class="fragment">Visualiser les relations entre objets de notre <em>pipeline</em> à partir de <code>tar_visnetwork()</code>.</li>
<li class="fragment">Exécuter <code>tar_make()</code> dans la console et observer le changement d’état avec <code>tar_visnetwork()</code>.</li>
<li class="fragment">Dans <code>script.R</code>:
<ol type="a">
<li class="fragment">remplacer la création de <code>pwd_api</code> par <code>tar_load(pwd_api)</code></li>
<li class="fragment">remplacer l’import de <code>individu_reg.parquet</code> par <code>tar_load(survey_sample_24)</code></li>
</ol></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-6b" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 6B</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Avantage de <code>targets</code>: ne pas refaire tourner tout le <em>pipeline</em> pour un changement intermédiaire</strong></p>
</div>
<div class="callout-content">
<div>
<!------
Le _pipeline_ n'est pas pleinement reproductible à ce stade car le fichier `write_csv.R`
fait toujours la transformation de base:
- créer une fonction `import_parquet_raw` dans `R/fonctions.R` pour modulariser cet import
et la sélection de l'échantillon (region=24). Changer le fichier `_targets.R` en conséquence. 
------>
<ol type="1">
<li class="fragment">Adopter la même approche de modularisation puis intégration dans <code>_targets.R</code> de la partie <em>feature engineering</em>. Faire un <code>tar_visnetwork()</code> avant de faire <code>tar_make()</code>. Faire un <code>tar_visnetwork()</code>.</li>
<li class="fragment">Créer une fonction <code>produce_table_age</code> pour produire le tableau <code>gt</code> que vous avez créé précédemment et intégrer sa production dans le <em>pipeline</em> défini dans <code>_targets.R</code> (sous le nom <code>table_age</code>)</li>
<li class="fragment">Exécuter <code>tar_make()</code> dans la console puis remplacer le code en question dans <code>script.R</code> par <code>tar_load(table_age)</code>.</li>
<li class="fragment">Il est nécessaire de recoder les valeurs <code>Z</code> en valeurs manquantes dans la variable <code>cat1</code>. Ajouter cela dans la fonction de recodage des valeurs manquantes.</li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-6b-1" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 6B</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Avantage de <code>targets</code>: ne pas refaire tourner tout le <em>pipeline</em> pour un changement intermédiaire (suite)</strong></p>
</div>
<div class="callout-content">
<div>
<ol start="5" type="1">
<li class="fragment">Après avoir sauvegardé <code>R/functions.R</code>, observer le changement dans le pipeline avec <code>tar_visnetwork()</code>.</li>
<li class="fragment">Faire un <code>tar_make()</code></li>
<li class="fragment">Ajouter deux éléments au <em>pipeline</em> :
<ul>
<li class="fragment">Choisir le graphique qu’on enregistrait sous le nom <code>surf_par_statut.png</code>. Faire une fonction pour le produire et l’intégrer dans le <em>pipeline</em>. Appeler la cible, <code>super_graphique</code>.</li>
<li class="fragment">Créer une fonction pour générer la régression à la fin. Faire une fonction pour le produire et intégrer dans le <em>pipeline</em>. Appeler la cible, <code>super_regression</code>.</li>
</ul></li>
<li class="fragment">Observer la fin du <em>pipeline</em> avec <code>tar_visnetwork()</code> puis faire <code>tar_make()</code>.</li>
<li class="fragment"><code>renv::snapshot()</code> puis commit/push.</li>
</ol>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="vi--publication-reproductible" class="title-slide slide level1 center" data-background-image="background.svg" data-background-size="contain">
<h1>VI- Publication reproductible</h1>

</section>
<section id="enjeux-4" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Enjeux</h2>
<ul>
<li>Produire des <strong>études reproductibles</strong> en intégrant le code et le texte dans un même document</li>
</ul>
<div class="fragment">
<ul>
<li>La génération complète de l’étude est contenue dans un <strong>unique projet</strong></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>Limiter les risques d’erreurs</strong> dûes aux gestes manuels</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Gestion native de <strong>différents formats</strong> pour le document final (<code>pdf</code>, <code>html</code>, <code>odt</code>, etc.)</li>
</ul>
</div>
</section>
<section id="r-markdown" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><code>R Markdown</code></h2>
<ul>
<li><code>R Markdown</code> est un <em>package</em> <code>R</code> qui permet de lier
<ul>
<li>Du <strong>texte</strong> au format <code>Markdown</code></li>
<li>Du <strong>code</strong> <code>R</code> qui peut être exécuté et dont les sorties peuvent être intégrées au texte</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><strong>Dissociation du fond et de la forme</strong> du document</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Un document est <strong>compilé</strong> en deux étapes
<ul>
<li><strong><em>knit</em></strong> : le package <code>knitr</code> transforme le texte et les sorties <code>R</code> en un document <code>Markdown</code> standard ;</li>
<li><strong><em>convert</em></strong> : le logiciel <code>pandoc</code> transforme le document <code>.md</code> en un format de sortie standard (<code>html</code>, <code>pdf</code>, etc.)</li>
</ul></li>
</ul>
</div>
</section>
<section id="quarto" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2><code>Quarto</code></h2>
<ul>
<li><code>Quarto</code> est le successeur de <code>R Markdown</code></li>
</ul>
<div class="fragment">
<ul>
<li><code>Quarto</code> supporte <strong>différents moteurs de calcul</strong> (<code>knitr</code>, <code>Jupyter</code>, <code>Observable</code>..) ce qui le rend nativement <strong>multi-langage</strong> (<code>R</code>, <code>Python</code>, <code>JavaScript</code>..)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Le fonctionnement des deux systèmes reste très proche</li>
</ul>
</div>
</section>
<section id="anatomie-dun-document-reproductible" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Anatomie d’un document reproductible</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/qmd.png" height="700"></p>
</figure>
</div>
</section>
<section id="ressources-supplémentaires-4" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Ressources supplémentaires</h2>
<ul>
<li><p>La <a href="https://rmarkdown.rstudio.com/lesson-1.html">documentation officielle de <code>R Markdown</code></a></p></li>
<li><p>La <a href="https://www.book.utilitr.org/rmarkdown.html">fiche <code>UtilitR</code> sur <code>R Markdown</code></a></p></li>
<li><p>La <a href="https://quarto.org/">documentation officielle de <code>quarto</code></a></p></li>
</ul>
</section>
<section id="exercice-7" class="slide level2" data-background-image="background.svg" data-background-size="contain">
<h2>Exercice 7</h2>
<div class="callout callout-tip no-icon callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<p><strong>Introduction à la publication reproductible</strong></p>
</div>
<div class="callout-content">
<div>
<ul>
<li class="fragment">Cliquer sur <code>File &gt; New file &gt; Quarto document</code>:
<ul>
<li class="fragment">Décocher la case <code>Use visual markdown editor</code></li>
<li class="fragment">Donner un titre et un auteur au rapport</li>
</ul></li>
<li class="fragment">Sauvegarder le fichier sous le nom <code>report.qmd</code></li>
<li class="fragment">S’inspirer de <a href="https://raw.githubusercontent.com/InseeFrLab/formation-bonnes-pratiques-R/1b6d4e88328c91b37da0b6f18f3dd1080db81aac/report.qmd">cette base de départ</a> pour créer votre rapport</li>
</ul>
</div>
</div>
</div>
</div>
<div class="footer footer-default">
<p>Bonnes pratiques pour les projets statistiques</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"whiteboard"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>